//
// Author: Puru Choudhary (www.terminusapp.com)
// URL: https://github.com/medius/utm_cookie
//
// Description:
// This script saves UTM parameters in cookies whenever there are any UTM parameters
// in the URL. It also saves the initial referrer information in a cookie which is
// never (365 days) overwritten.
//
// Adding this script is useful for custom tracking. e.g. The values in the cookies
// can be read and added to forms or stored in the backend database, etc.
//
var utmCookie={cookieNamePrefix:"_uc_",utmParams:["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],cookieExpiryDays:365,crossSubDomain:!0,createCookie:function(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="; expires="+d.toGMTString()}else var e="";var f=this.cookieNamePrefix+a+"="+b+e+"; path=/";f+=this.crossSubDomain?"; domain=."+window.location.hostname.replace("www.",""):"",document.cookie=f},readCookie:function(a){for(var b=this.cookieNamePrefix+a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null},eraseCookie:function(a){this.createCookie(a,"",-1)},getParameterByName:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.search);return null==d?"":decodeURIComponent(d[1].replace(/\+/g," "))},utmPresentInUrl:function(){for(var a=!1,b=0;b<this.utmParams.length;b++){var c=this.utmParams[b],d=this.getParameterByName(c);""!=d&&void 0!=d&&(a=!0)}return a},writeUtmCookieFromParams:function(){for(var a=0;a<this.utmParams.length;a++){var b=this.utmParams[a],c=this.getParameterByName(b);this.createCookie(b,c,this.cookieExpiryDays)}},writeCookieOnce:function(a,b){var c=this.readCookie(a);c||this.createCookie(a,b,this.cookieExpiryDays)},writeReferrerOnce:function(){value=document.referrer,""===value||void 0===value?this.writeCookieOnce("referrer","direct"):this.writeCookieOnce("referrer",value)},referrer:function(){return this.readCookie("referrer")}};utmCookie.writeReferrerOnce(),utmCookie.utmPresentInUrl()&&(console.log("writing cookies"),utmCookie.writeUtmCookieFromParams());